# HDFS

##### HDFS 특징 (목표)

```
- 장애 복구

	장애의 빠른시간 대처 / 복구 / 복제데이터

- 스트리밍 방식의 데이터 접근

	요청을 빠른 시간내에 처리하는 것보다는 동일한 시간 내에 처리

- 대용량 데이터 저장

- 데이터 무결성

	무결성원칙 - 변조를 할 수 없다 
	append는 가능하다
```



##### HDFS 아키텍처



![HDFS분산](https://user-images.githubusercontent.com/49560745/62588872-4928e200-b902-11e9-8363-5ae0db5a009c.PNG)

```
블록 구조 파일 시스템

- HDFS에 저장하는 파일은 특정 크기(통상 64MB)의 블록으로 나눠저 분산된 서버에 저장된다
 = > 큰 규모의 데이터 저장 가능
 
블록 크기가 64MB인 이유

- 디스크 시크 타임 감소
- 네임노드가 유지하는 메타데이터의 크기 감소
- 클라이언트와 네임노드의 통신 감소

```

##### 네임노드와 데이터노드

```
네임노드 : 마스터
데이터노드 : 슬레이브
(maters slaves (in conf) 와는 다르게 생각하자)
보조 네임노드 : 메타데이터 BACKUP

파일 읽기/쓰기요청 : 클라이언트 -> HDFS 클러스터
파일 제어요청 : 클라이언트 -> 네임노드 -> HDFS 클러스터
파일 읽기/쓰기 응답 : HDFS 클러스터 -> 클라이언트
하트비트 전송 : alive함 + 블록의 목록을 데이터노드가 -> 네임노드로 전송하는 것
블록관리 : 네임노드는 장애가 발생한 데이터노드를 발견하면 해당 데이터노드의 블록을 새로운 			데이터노드로 복제

클라이언트 요청 접수 : 클라이언트가 HDFS에 접근하려면 반드시 네임노드에 먼저 접속해야 
					한다 
					
					
					name : 메타정보
					data : 물리적으로 big data의 블록이 저장되는 공간
					tmp : 임시적으로 (backup의 느낌(?))
```



##### 파일 저장 요청

```
클라이언트 -----> DistributedFileSystem -------> DFSClient -------> 네임노드
		스트림요청                     스트림생성          유효성검사요청
```



##### 블록조회

![블록조회](https://user-images.githubusercontent.com/49560745/62590143-6364bf00-b906-11e9-9ac6-44429387ac42.PNG)



##### 보조네임노드

```
- 네임노드는 메타데이터를 메모리에서 처리
- 메모리에만 데이터를 유지할 경우 유실 위험 존재
- 따라서 HDFS는 editslog 와 fsimage라는 두개의 파일을 생성하여 이를 극복


fsimage : 최신정보 (딱 하나의 정보)
editslog : log가 계속 쌓인다

* 메타데이터 : 데이터의 데이터
			=> 데이터의 형식이 다양화되고 있는 상황에서 원하는 정보를 빠르게 찾아나가기 				위해 ( 하드디스크 용량 / 데이터 용량 / 목록 )
```



##### HDFS 명령어

```
- 파일 용량 확인
hadoop fs -du

- 삭제
hadoop fs -rmr /mydir

- 파일생성
hadoop fs -touchz filename

- 휴지통비우기 (hadoop은 삭제하면 휴지통으로~)
hadoop fs -expunge

```





