# DB설계 - 쇼핑몰

```SQL
- DDL : CREATE TABLE

CREATE TABLE T_CUSTOMER(
ID VARCHAR2(20),
NAME VARCHAR2(20),
PHONE VARCHAR2(20),
ADDR VARCHAR2(20)
)

CREATE TABLE T_P(
ID NUMBER(20),
CATEGORY NUMBER(20),
PRICE NUMBER(20),
IMG VARCHAR2(20),
REGDATE DATE
)

CREATE TABLE T_ORDER(
ID VARCHAR2(20),
CID VARCHAR2(20),
TOTAL NUMBER(20),
QT NUMBER(20),
DELINFO VARCHAR2(20),
STATUS VARCHAR2(20),
PAYTYPE VARCHAR2(20),
RATE NUMBER(20),
ORDATE DATE
)

CREATE TABLE T_CART(
ID NUMBER(20),
PID NUMBER(20),
CID VARCHAR2(20),
QT VARCHAR2(20),
CADATE DATE
)

CREATE TABLE T_CATE(
ID NUMBER(20),
NAME VARCHAR2(20)
)

CREATE TABLE T_ORDERDE(
ID NUMBER(20),
OID VARCHAR2(20),
PID NUMBER(20),
QT NUMBER(20),
PRICE NUMBER(20),
STATUS VARCHAR2(20)
)

- DDL : ADD PRIMARY KEYS

ALTER TABLE T_CUSTOMER ADD PRIMARY KEY(ID);
ALTER TABLE T_P ADD PRIMARY KEY(ID);
ALTER TABLE T_CATE ADD PRIMARY KEY(ID);
ALTER TABLE T_CART ADD PRIMARY KEY(ID);
ALTER TABLE T_ORDER ADD PRIMARY KEY(ID);
ALTER TABLE T_ORDERDE ADD PRIMARY KEY(ID);

- DDL : ADD FOREIGN KEYS

ALTER TABLE T_P ADD FOREIGN KEY(CATEGORY) REFERENCES T_CATE(ID);
ALTER TABLE T_CART ADD FOREIGN KEY(CID) REFERENCES T_CUSTOMER(ID);
ALTER TABLE T_CART ADD FOREIGN KEY(PID) REFERENCES T_P(ID);
ALTER TABLE T_ORDER ADD FOREIGN KEY(CID) REFERENCES T_CUSTOMER(ID);
ALTER TABLE T_ORDERDE ADD FOREIGN KEY(PID) REFERENCES T_P(ID);
ALTER TABLE T_ORDERDE ADD FOREIGN KEY(OID) REFERENCES T_ORDER(ID);

- DDL : ADD SEQUENCES

CREATE SEQUENCE SEQ_PROD
START WITH 1000
INCREMENT BY 1

CREATE SEQUENCE SEQ_CART
START WITH 1
INCREMENT BY 1

CREATE SEQUENCE SEQ_CATE
START WITH 1
INCREMENT BY 1

CREATE SEQUENCE SEQ_ORD
START WITH 100
INCREMENT BY 1

CREATE SEQUENCE SEQ_ODD
START WITH 100
INCREMENT BY 1

- DML : INSERT

INSERT INTO T_CUSTOMER VALUES (
'ID01',
'JIHOON',
'010-1234-5678',
'SEOUL'
);

INSERT INTO T_CATE VALUES (
SEQ_CATE.NEXTVAL,
'BEER'
)

INSERT INTO T_P VALUES ( 
SEQ_PROD.NEXTVAL,
1,
3000,
'BEER.JPG',
SYSDATE
)

INSERT INTO T_ORDER VALUES ( 
TO_CHAR(SYSDATE,'YYYYMMDDHH24MISS')||TO_CHAR(SEQ_ORD.NEXTVAL),
'ID01',
9000,
1,
'CA-JH',
'SHIPPING',
'CARD',
0.05,
SYSDATE
)

INSERT INTO T_CART VALUES ( 
SEQ_CART.NEXTVAL,
1000,
'ID01',
'3',
SYSDATE
)

INSERT INTO T_ORDERDE VALUES (
SEQ_ODD.NEXTVAL,
'20190709133106103', 
1000, 
1, 
3000, 
'ORDER COMPLETE' 
);

- DML : UPDATE

UPDATE T_ORDER SET TOTAL = (SELECT SUM(PRICE * QT) FROM T_ORDERDE WHERE OID= '20190709133106103') * RATE, 
QT = (SELECT COUNT(*) FROM T_ORDERDE WHERE OID= '20190709133106103') WHERE ID='20190709133106103';

- DML : SELECT

SELECT T_ORDER.ID AS ORDER_ID, CID AS CUSTOMER_ID, TOTAL, T_ORDER.QT AS ORDER_QT, DELINFO, T_ORDER.STATUS, PAYTYPE, ORDATE AS ORDER_DATE, T_ORDERDE.ID AS ODD_ID, PID AS PRODUCT_ID, T_ORDERDE.QT AS ODD_QT, PRICE, T_ORDERDE.STATUS FROM T_ORDER JOIN T_ORDERDE ON T_ORDER.ID = T_ORDERDE.OID ORDER BY T_ORDER.ID;


```



결과

![RESULT](C:\Users\student\Desktop\RESULT.png)
