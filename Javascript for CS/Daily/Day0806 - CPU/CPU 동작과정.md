# CPU

- cpu 역할

```
중앙처리장치 - 명령어의 해석과 자료의 연산, 비교 등의 처리를 제어하는 컴퓨터시스템의 핵심장치

=> 주기억장치에서 프로그램 명령어와 데이터를 읽어와서 처리하고, 명령어의 수행순서를 제어한다.	

1) 기억장치로부터 명령어를 인출
2) 인출된 명령어 해독
3) 필요한 연산 수행
4) 기억장치를 통해 데이터에 접근하는데 필요한 기억장치 주소와 제어신호 제공
```

- cpu 구성요소

```
처리(연산) 장치 
- 산술연산, 논리연산 수행
- 연산에 필요한 데이터를 레지스터로부터 가져오고 다시 레지스터로 보내는 역할

제어장치

- 명령어를 순차적으로 실행할 수 있도록 제어하는 장치

레지스터 

- 컴퓨터에서 가장 빠른 기억장치
- cpu에서는 주기억장치로부터 읽어 온 명령어와 데이터를 임시적으로 보관할 수 있는 장치가 필요하며,
ALU에서 처리된 결과를 임시적으로 저장하기 위한 장치
	   	
프로그램 카운터(PC) 
- 다음에 수행할 명령어의 주소를 저장한다.

내부버스
```

- 레지스터 종류

```
MBR (Memory Buffer Register)
- 기억장치에 저장될 단어를 가지고 있거나, 기억장치로부터 읽혀진 다음 단어를 저장하는데 사용
	
MAR(Memory Address Register)
- MBR로부터 쓰여지거나 읽혀질 단어의 기억장치 주소를 저장

IR (Instruction Register) === Program Counter
- 실행될 명령어의 연산코드를 저장

```

- cpu 동작과정

```
cpu 동작과정
1. 주기억장치는 입력 데이터 혹은 보조기억장치에서 저장된 프로그램을 읽어온다.
2. 중앙처리장치는 주기억장치에 저장된 프로그램 명령어와 데이터를 읽어와 결과를 다시 주기억장치에 저장한다.
3. 주기억장치는 처리결과를 보조기억장치에 저장하거나
출력장치로 보낸다.
4. 제어장치는 1~3 과정에서 명령어가 순서대로 실행될 수 있도록
각 장치를 제어한다.
```

## 명령어 처리 과정

```
주기억장치 -> 명령어 인출 -> 명령어 해독 -> 명령어 실행 -> 저장 -> 명령어처리
```

## 1) 명령어 인출

```xml
기억장치로부터 명령어를 가져온다. 인출된 명령어의 주소는 PC에 들어있고, 
인출된 명령어는 '명령어 레지스터(IR)'로 옮겨진다.

 1. MAR <- PC
 2. MBR <- M[MAR], PC <- PC+1
 3. IR <- MBR
```

## 2) 명령어 실행

```
명령어 레지스터에 실린 명령어를 해독하고, 해독한 명령어에 따라 연산수행
다음의 3 step(정확히는 4 step + 순서제어)으로 나뉜다.
```

### 1. 데이터 이동

```XML
- 기억장치와 CPU 혹은 입출력장치 사이에 데이터 이동
- 'LOAD'명령어 사용
- LOAD : 데이터 이동을 위한 명령어, 원하는 기억장치의 데이터를 CPU 내부레지스터인 누산기로 가져오는 명령어

1) 누산기로 이동할 데이터가 들어 있는 주소가 MAR에 실린다. 
2) MAR에 있는 주소의 데이터가 MBR에 실린다.
3) MBR에 들어 있는 데이터를 누산기로 읽어온다.

 1. MAR <- IR(Address)
 2. MBR <- M[MAR]
 3. AC <- MBR
```

### 2. 데이터 처리

```XML
산술연산 또는 논리연산을 통한 데이터처리

산술연산 중 하나인 ADD 명령을 처리해보자.
- 누산기에 있는 데이터와 기억장치에 있는 데이터를 더한 후 그 결과를 누산기에 저장한다.

1) 더해질 데이터가 들어 있는 기억장치의 주소가 MAR에 실린다. 
2) MAR에 있는 기억장치주소에 해당하는 데이터가 MBR에 실린다. 
3) 누산기에 있는 데이터와 MBR에 있는 데이터가 더해지고, 결과가 누산기에 저장된다. 

2. 마이크로 연산 표현

 1. MAR <- IR(Address)
 2. MBR <- M[MAR]
 3. AC <- AC+MBR
```

### 3. 데이터 저장

```XML
연산결과를 기억장치에 저장

STORE 명령
- 연산결과를 갖고 있는 누산기의 데이터를 기억장치에 저장하는 동작 수행

1) 저장될 주소가 MAR에 실린다. 
2) 누산기에 있는 데이터가 MBR에 실린다. 
3) MBR에 있는 데이터가 MAR에 있는 주소로 저장된다. 
 
 1. MAR <- IR(Address)
 2. MBR <- AC
 3. M[MAR] <- MBR
```

- 참고 

[https://sangcho.tistory.com/entry/%EC%A4%91%EC%95%99%EC%B2%98%EB%A6%AC%EC%9E%A5%EC%B9%98CPU](https://sangcho.tistory.com/entry/중앙처리장치CPU)

