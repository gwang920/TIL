

# 세마포어 & 뮤텍스

```
동시성 프로그래밍의 가장 큰 숙제는 '공유자원 관리'이다.
공유자원을 안전하게 관리하기 위해 상호배제(Mutual exclusion)를 달성하는 기법이 필요하다.

세마포어와 뮤텍스가 바로 상호배제를 달성하기 위한 기법이다.

세마포어와 뮤텍스를 보통 '화장실'에 비유하곤한다. 
아래에서 살펴보자
```

## 뮤텍스

```
뮤텍스는 화장실이 하나인 식당이라고 생각하면된다.
우선, 이 식당의 화장실에 가려면 키가 필요하다.
키를 가진 사람이 화장실에 들어갔을 때
만약 다른 사람이 화장실에 가려면 키가 없기 때문에 화장실에 접근할 수 없다.
이때 대기줄이 생기는 것이다.

그러다 화장실에서 나온사람이 키를 대기자에게 전달하면 이제 사이클이 돌기시작하는 것이다.

뮤텍스에서 화장실은 공유자원, 화장실키는 공유자원에 접근하기 위한 오브젝트키, 화장실을 이용하는 사람들은
프로세스나 스레드가 된다.
```

## 세마포어

```
세마포어는 뮤텍스와 조금 다르다.
조금 더 여유롭게 화장실이 여러개 있는 식당이다.
그리고 화장실 빈칸 개수를 보여주는 전광판이있다.

화장실을 이용하기전에 이 빈칸으 개수를 확인한다.
빈칸의 개수가 1이상이면 화장실로 가게되고, 전광판에 빈칸 개수를 하나 줄인다.

그러다 빈칸 개수가 0이 되면 대기자가 발생하게 되는 것이다.

그리고 화장실을 이용하고 나올 때 이 전광판의 빈칸 개수를 하나 늘려준다.

세마포어를 이러한 방식으로 비유할 수 있다.

뮤텍스와 마찬가지로 화장실은 공유자원, 화장실키는 공유자원에 접근하기 위한 오브젝트키, 화장실을 이용하는 사람들은 프로세스나 스레드가 된다.

```

