# 프로세스 & 쓰레드

```
단일 프로세스는 하나의 프로그램을 하나의 프로세스로 실행하는 것
멀티 프로세스는 하나의 프로그램을 여러개의 프로세스로 실행하는 것

이때, 멀티프로세싱은 context swithcing 기법을 활용해 여러 프로세스를 동시에 구동되는 것 처럼 눈속임을 할 수 있다.

하지만, 멀티 프로세싱은 context switching으로부터 발생되는 비용 문제가 있다.
왜냐하면 프로세스는 서로 간의 자원을 공유하지 않는다. 즉 프로세스는 각각 독립적인 공간을 할당받는 것이다.
그렇기 때문에 context switching으로부터 발생되는 비용이 만만치 않다.
이를 보완하기 위해 쓰레드를 사용하는 것이다.

하나의 프로세스에는 최소 한개 이상의 쓰레드가 존재한다.
이때 쓰레드가 여러개라면 이게 바로 멀티 쓰레드가 되는 것이다.
쓰레드는 프로세스와는 다르게 stack 영역을 제외하고 나머지 영역(heap,data 등)을 공유하기 때문에
멀티 프로세스의 context switching 비용문제를 해결할 수 있다.
```



# 프로세스

```javascript
프로세스(Process)란
- 컴퓨터에서 연속적으로 실행되고 있는 컴퓨터 프로그램
- 메모리에 올라와 실행되고 있는 프로그램의 인스턴스(독립적인 개체)
  독립된 메모리 영역(Code,Data,Stack,Heap)
- 운영체제로부터 시스템 자원을 할당받는 작업의 단위
- 동적인 개념으로는 "실행된 프로그램"을 의미
```

## 프로세스 메모리 구조

| Kernel |
| :----: |
| Stack  |
|  Heap  |
|  Bss   |
|  Data  |
|  Code  |

![image](https://user-images.githubusercontent.com/49560745/89875199-ebeffc80-dbf7-11ea-9c45-05c419df4fdb.png)

​                                                          출처 : https://kyoun.tistory.com/34

## 다중 프로세스 성능 향상법

```
1) 멀티쓰레드

왜 멀티프로세스 보다 멀티쓰레드 인가?

간단한 예시로 설명하자면 멀티프로세스는 문서작업을 할 때 여러개의 문서 프로그램을 켜두는 것이고, 멀티 스레드는 문서 프로그램내에서 새로운 문서창을 띄우는 것으로 이해 할 수 있다. 
따라서 운영체제가 받는 부담이 확 줄어들게 된다.

1. 자원의 효율
 여러 프로세스를 할당하는 등의 시스템 콜(커널영역의 기능을 사용자 영역에서 사용가능하게 하는 작업)이 줄어든다.
 
2. 처리비용, 응답시간 단축
 스레드간 통신은 stack을 제외한 모든 메모리를 공유하기 때문에 프로세스간 통신보다 훨씬 비용이 적게 소모된다. (* 프로세스 통신은 IPC가 필요하다)


2) context switching 성능 향상

시스템을 디자인하는 데 있어서(프로그램을 구현하는 데 있어서), 이러한 컨텍스트 스위칭 부담을 최소화 노력해야한다.

해결 방안	
1. 프로그램 다중화 수준 낮춤	– 다중 프로그래밍 수준을 낮추어 문맥 교환 발생 빈도 감소
2. 스레드 이용	– Light Weight 프로세스인 스레드를 이용하여 문맥 교환 부하 최소화
3. 스택포인터 활용	– 스택 이용 프로그램의 경우 스택 포인터를 이용하여 문맥 교환 부하 최소화
멀티프로세스 환경에서 문맥교환은 필수적이므로 정보교환의 최소화 및 최적화가 필요

* context switching
CPU가 어떤 프로세스를 실행하고 있는 상태에서 인터럽트에 의해 다음 우선 순위를 가진 프로세스가 실행되어야 할 때 기존의 프로세스 정보들은 PCB에 저장하고 다음 프로세스의 정보를 PCB에서 가져와 교체하는 작업을 컨텍스트 스위칭이라 한다.

출처: https://www.crocus.co.kr/1364 [Crocus]
```

![image](https://user-images.githubusercontent.com/49560745/89894334-e9e86680-dc14-11ea-97cd-f1f6762838c6.png)





